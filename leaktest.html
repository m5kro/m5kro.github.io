<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IP Geolocation Information</title>
</head>
<body>
  <h1>Your IP Geolocation Information</h1>
  <ul id="ip-list">Your IPs are:</ul>

  <script>
    // Function to retrieve IP addresses
    function findIP(onNewIP) {
      var myPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;
      var pc = new myPeerConnection({iceServers: [{urls: "stun:stun.l.google.com:19302"}]}),
          noop = function() {},
          localIPs = {},
          ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g;

      function ipIterate(ip) {
        if (ip === '0.0.0.0' || localIPs[ip]) return; // Ignore 0.0.0.0 and duplicates
        onNewIP(ip);
        localIPs[ip] = true;
      }
      
      pc.createDataChannel("");
      pc.createOffer().then(function(sdp) {
        sdp.sdp.split('\n').forEach(function(line) {
          if (line.indexOf('candidate') < 0) return;
          line.match(ipRegex).forEach(ipIterate);
        });
        pc.setLocalDescription(sdp, noop, noop);
      }).catch(noop);
      
      pc.onicecandidate = function(ice) {
        if (!ice || !ice.candidate || !ice.candidate.candidate || !ice.candidate.candidate.match(ipRegex)) return;
        ice.candidate.candidate.match(ipRegex).forEach(ipIterate);
      };
    }

    // Function to display IPs and fetch geolocation data
    function displayIPData(ip) {
      var ul = document.getElementById('ip-list');
      var li = document.createElement('li');
      li.textContent = `IP: ${ip}`;
      ul.appendChild(li);
      
      // Fetch geolocation data for each IP
      fetch(`https://tools.keycdn.com/geo.json?host=${ip}`)
        .then(response => response.json())
        .then(data => {
          if (data && data.data && data.data.geo) {
            const geo = data.data.geo;
            var geoInfo = document.createElement('li');
            geoInfo.innerHTML = `
              <strong>IP:</strong> ${geo.ip} <br>
              <strong>Country:</strong> ${geo.country_name} (${geo.country_code})<br>
              <strong>Region:</strong> ${geo.region_name} (${geo.region_code})<br>
              <strong>City:</strong> ${geo.city}<br>
              <strong>Latitude:</strong> ${geo.latitude}<br>
              <strong>Longitude:</strong> ${geo.longitude}<br>
              <strong>Timezone:</strong> ${geo.timezone}<br>
              <strong>Date & Time:</strong> ${geo.datetime}<br>
            `;
            ul.appendChild(geoInfo);
          } else {
            li.textContent += " - Geolocation data not available";
          }
        })
        .catch(error => {
          console.error('Error fetching geolocation data:', error);
          li.textContent += " - Error fetching geolocation data";
        });
    }

    // Start finding IP addresses
    findIP(displayIPData);
  </script>
</body>
</html>
